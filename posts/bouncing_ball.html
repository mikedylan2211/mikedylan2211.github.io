<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Interactive Bouncing Ball Simulation with collision detection and energy loss.">
<title>Bouncing Ball Simulation - Mike Dylan Poppelaars</title>
<link rel="stylesheet" href="../style.css">
<style>
canvas {
  background-color: var(--bg-code);
  border: 2px solid var(--border);
  display: block;
  max-width: 100%;
  width: 100%;
  height: auto;
}

.controls {
  margin-top: 1rem;
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  justify-content: center;
}

button {
  padding: 0.5rem 1rem;
  background: var(--bg-code);
  color: var(--green);
  border: 1px solid var(--border);
  border-radius: 4px;
  cursor: pointer;
  font-family: inherit;
  font-weight: bold;
}

button:hover {
  background: var(--green);
  color: var(--bg-main);
}

@media (max-width: 600px) {
  .controls { flex-direction: column; }
}
</style>
</head>

<body>
<header>
  <h1>./bouncing_ball.sh</h1>
  <p class="meta">Last edited: <time datetime="2025-10-15">October 15, 2025</time></p>
  <p><a href="../index.html">← Back to home</a></p>
</header>

<main>
  <section>
    <canvas id="canvas" width="800" height="500"></canvas>

    <div class="controls">
      <button onclick="resetBall()">Reset Ball</button>
      <button onclick="toggleGravity()">Toggle Gravity</button>
      <button onclick="toggleFriction()">Toggle Friction</button>
      <button onclick="addRandomBall()">Add Random Ball</button>
    </div>
  </section>
</main>

<footer>
  <p><a href="../index.html">← Back to home</a></p>
</footer>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let balls = [{ x: 100, y: 100, radius: 20, velocityX: 5, velocityY: 0, gravity: 0.5, color: 'red', friction: 0.9 }];
let gravityEnabled = true;
let frictionEnabled = true;

function createBall(x, y, color = null) {
  const colors = ['red','blue','green','orange','purple','cyan'];
  return {
    x, y,
    radius: 15 + Math.random() * 15,
    velocityX: -5 + Math.random() * 10,
    velocityY: -10 + Math.random() * 5,
    gravity: 0.5,
    color: color || colors[Math.floor(Math.random() * colors.length)],
    friction: 0.8 + Math.random() * 0.1
  };
}

function animate() {
  ctx.fillStyle = 'rgba(0,0,0,0.1)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  balls.forEach(ball => {
    if (gravityEnabled) ball.velocityY += ball.gravity;
    ball.x += ball.velocityX;
    ball.y += ball.velocityY;

    // bounce off walls
    const bounceFriction = frictionEnabled ? ball.friction : 1;
    if (ball.x + ball.radius > canvas.width) { ball.x = canvas.width - ball.radius; ball.velocityX *= -bounceFriction; }
    if (ball.x - ball.radius < 0) { ball.x = ball.radius; ball.velocityX *= -bounceFriction; }
    if (ball.y + ball.radius > canvas.height) { ball.y = canvas.height - ball.radius; ball.velocityY *= -bounceFriction; if (Math.abs(ball.velocityY) < 0.5) ball.velocityY = 0; }
    if (ball.y - ball.radius < 0) { ball.y = ball.radius; ball.velocityY *= -bounceFriction; }

    ctx.save();
    // shadow
    ctx.beginPath();
    ctx.arc(ball.x+2, ball.y+2, ball.radius, 0, Math.PI*2);
    ctx.fillStyle = 'rgba(0,0,0,0.2)';
    ctx.fill();
    // main ball
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
    ctx.fillStyle = ball.color;
    ctx.fill();
    // highlight
    ctx.beginPath();
    ctx.arc(ball.x - ball.radius/3, ball.y - ball.radius/3, ball.radius/4, 0, Math.PI*2);
    ctx.fillStyle = 'rgba(255,255,255,0.3)';
    ctx.fill();
    ctx.restore();
  });

  requestAnimationFrame(animate);
}

function resetBall() { balls = [createBall(100, 100, 'red')]; }
function toggleGravity() { gravityEnabled = !gravityEnabled; }
function toggleFriction() { frictionEnabled = !frictionEnabled; }
function addRandomBall() {
  balls.push(createBall(Math.random()*canvas.width, Math.random()*canvas.height/2));
  if (balls.length > 10) balls.shift();
}

canvas.addEventListener('click', e => {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;
  const x = (e.clientX - rect.left) * scaleX;
  const y = (e.clientY - rect.top) * scaleY;
  balls.push(createBall(x, y));
  if (balls.length > 10) balls.shift();
});

animate();
</script>
</body>
</html>
